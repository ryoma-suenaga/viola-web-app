<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VIOLA | ams OSRAM Controller</title>
    <style>
        :root { --accent: #ff5e00; --bg: #050505; --card: #141414; --text: #ffffff; --danger: #ff0000; }
        body { font-family: 'Inter', sans-serif; background: var(--bg); color: var(--text); margin: 0; display: flex; flex-direction: column; align-items: center; min-height: 100vh; padding-bottom: 50px; }
        .header { width: 100%; padding: 30px 0; text-align: center; background: linear-gradient(180deg, #111 0%, transparent 100%); }
        .logo-img { width: 220px; height: auto; margin-bottom: 5px; filter: drop-shadow(0 0 12px rgba(255,94,0,0.3)); }
        h1 { margin: 0; font-size: 0.9rem; letter-spacing: 5px; font-weight: 300; color: #777; text-transform: uppercase; }
        
        #matrix-shell { background: #000; padding: 15px; border-radius: 20px; border: 1px solid #222; box-shadow: 0 10px 40px rgba(0,0,0,1); margin: 15px 0; }
        #matrix { display: grid; grid-template-columns: repeat(8, 30px); gap: 5px; }
        .led { width: 30px; height: 30px; background: #111; border-radius: 4px; position: relative; }
        .led::after { content: ''; position: absolute; inset: 0; border-radius: 4px; filter: blur(5px); opacity: 0.8; background: inherit; }

        .container { width: 92%; max-width: 400px; display: flex; flex-direction: column; gap: 12px; }
        .card { background: var(--card); border-radius: 16px; padding: 18px; border: 1px solid #222; }
        .label { font-size: 0.65rem; color: #555; text-transform: uppercase; letter-spacing: 2px; margin-bottom: 10px; display: block; font-weight: bold; }
        
        button { background: #1a1a1a; border: 1px solid #333; color: #fff; padding: 12px; border-radius: 10px; cursor: pointer; transition: 0.2s; font-size: 0.8rem; text-transform: uppercase; }
        button:active { background: var(--accent); color: #000; transform: scale(0.98); }
        .btn-primary { background: var(--accent); color: #fff; border: none; font-weight: bold; width: 100%; box-shadow: 0 4px 12px rgba(255,94,0,0.2); }

        /* Text Input Style */
        .text-input { width: 100%; padding: 12px; background: #000; border: 1px solid #333; color: var(--accent); border-radius: 8px; font-family: monospace; margin-bottom: 10px; box-sizing: border-box; }

        #colorCanvas { width: 100%; height: 180px; border-radius: 50%; cursor: crosshair; touch-action: none; background: #000; }
        input[type="range"] { width: 100%; accent-color: var(--accent); margin: 8px 0; }
        .grid-2 { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
    </style>
</head>
<body>
    <div class="header">
        <img src="Logo.png" alt="ams OSRAM" class="logo-img">
        <h1>VIOLA MATRIX CONTROLLER</h1>
    </div>

    <div id="matrix-shell"><div id="matrix"></div></div>

    <div class="container">
        <div class="card">
            <span class="label">Scrolling Text Interface</span>
            <input type="text" id="scrollText" class="text-input" maxlength="50" placeholder="Type message here (Max 50)...">
            <button class="btn-primary" onclick="runMode('text')">Update & Scroll Text</button>
        </div>

        <div class="card">
            <span class="label">Solid State Color</span>
            <canvas id="colorCanvas"></canvas>
        </div>

        <div class="card">
            <span class="label">Global Intensity (GCC)</span>
            <input type="range" id="gccRange" min="0" max="255" value="180" oninput="updateGCC(this.value)">
        </div>

        <div class="card">
            <span class="label">Advanced Algorithms</span>
            <div class="grid-2">
                <button onclick="runMode('flame')">FLAME</button>
                <button onclick="runMode('ocean')">OCEAN</button>
                <button onclick="runMode('pastel')">PASTEL</button>
                <button onclick="runMode('flower')">FLOWER</button>
                <button onclick="runMode('aurora')">AURORA</button>
                <button onclick="runMode('off')" style="color:#ff4444;">OFF</button>
            </div>
        </div>
    </div>

    <script>
        // --- Perlin-based Noise ---
        const noise=(()=>{const p=new Uint8Array(512);for(let i=0;i<256;i++)p[i]=i;for(let i=255;i>0;i--){const r=Math.floor(Math.random()*(i+1));[p[i],p[r]]=[p[r],p[i]]}for(let i=0;i<256;i++)p[256+i]=p[i];const fade=t=>t*t*t*(t*(t*6-15)+10);const lerp=(t,a,b)=>a+t*(b-a);const grad=(hash,x,y,z)=>{const h=hash&15,u=h<8?x:y,v=h<4?y:h==12||h==14?x:z;return((h&1)==0?u:-u)+((h&2)==0?v:-v)};return(x,y,z)=>{const X=Math.floor(x)&255,Y=Math.floor(y)&255,Z=Math.floor(z)&255;x-=Math.floor(x);y-=Math.floor(y);z-=Math.floor(z);const u=fade(x),v=fade(y),w=fade(z),A=p[X]+Y,AA=p[A]+Z,AB=p[A+1]+Z,B=p[X+1]+Y,BA=p[B]+Z,BB=p[B+1]+Z;return lerp(w,lerp(v,lerp(u,grad(p[AA],x,y,z),grad(p[BA],x-1,y,z)),lerp(u,grad(p[AB],x,y-1,z),grad(p[BA+1],x-1,y-1,z))),lerp(v,lerp(u,grad(p[AA+1],x,y,z-1),grad(p[BA+1],x-1,y,z-1)),lerp(u,grad(p[AB+1],x,y-1,z-1),grad(p[BB+1],x-1,y-1,z-1))))}})();

        const matrixEl = document.getElementById('matrix'), leds = [];
        let gcc = 0.7, animTimer = null, time = 0;
        
        // --- Initialize 8x8 Grid ---
        for (let i = 0; i < 64; i++) {
            const led = document.createElement('div');
            led.className = 'led';
            matrixEl.appendChild(led);
            leds.push(led);
        }

        function draw(x, y, r, g, b) {
            const index = y * 8 + x;
            if (leds[index]) {
                leds[index].style.background = `rgb(${Math.floor(r*gcc)},${Math.floor(g*gcc)},${Math.floor(b*gcc)})`;
            }
        }

        // --- Basic 5x7 Font for Text Simulation ---
        const font = {'A':[31,36,68,36,31],'B':[127,73,73,73,54],'H':[127,8,8,8,127], 'I':[65,127,65], 'O':[62,65,65,65,62], 'L':[127,64,64,64,64], 'V':[31,32,64,32,31], ' ':[0,0,0], '❤️':[12,30,62,124,62,30,12]};
        
        function runMode(mode) {
            stop();
            if (mode === 'off') { leds.forEach(l => l.style.background = '#080808'); return; }
            animTimer = setInterval(() => {
                time += 0.03;
                for(let y=0; y<8; y++) {
                    for(let x=0; x<8; x++) {
                        if (mode === 'flame') {
                            let n = noise(x * 0.45, y * 0.2 + time * 3.5, time * 0.4);
                            let heat = (n * 0.5 + 0.5) * 255 * (1.2 - y/6.5);
                            draw(x, y, heat, Math.pow(heat, 2.2)/255**1.2, Math.pow(heat, 3.5)/255**2.5);
                        } else if (mode === 'ocean') {
                            let w = noise(x*0.35 - time, y*0.25, time * 0.15);
                            let amp = Math.sin(x*0.6 + time*2.8 + w*4.5);
                            let baseB = (amp*0.5 + 0.5)*180 + 75;
                            let f = Math.max(0, (amp - 0.35) / 0.65); // Smoother foam transition
                            draw(x, y, baseB*f, baseB*0.4 + baseB*0.6*f, baseB);
                        } else if (mode === 'pastel') {
                            let r = (noise(x*0.07, y*0.07, time*0.25) * 0.5 + 0.5) * 255;
                            let g = (noise(x*0.07, y*0.07, time*0.25+15) * 0.5 + 0.5) * 255;
                            let b = (noise(x*0.07, y*0.07, time*0.25+30) * 0.5 + 0.5) * 255;
                            draw(x, y, r, g, b);
                        } else if (mode === 'flower') {
                            let d = Math.sqrt((x-3.5)**2 + (y-3.5)**2);
                            let angle = Math.atan2(y-3.5, x-3.5);
                            let ripple = Math.sin(d * 1.5 - time * 6 + Math.sin(angle * 5) * 2);
                            let hue = (time * 50 + d * 20) % 360;
                            let [r,g,b] = hsvToRgb(hue, 1, ripple > 0 ? 0.8 : 0.2);
                            draw(x, y, r, g, b);
                        } else if (mode === 'aurora') {
                            // Professional Multi-color Aurora Gradient
                            let n = noise(x*0.12 + time, y*0.04, time*0.08);
                            let lum = Math.pow(Math.sin(x*0.35 + n*5.5) * 0.5 + 0.5, 2.5);
                            // Vertical color shift: Green top (120), Purple bottom (280)
                            let hueBase = (140 + Math.sin(time*0.5)*40); 
                            let hue = (hueBase + y * 15) % 360; 
                            draw(x, y, ...hsvToRgb(hue, 0.9, lum));
                        } else if (mode === 'text') {
                            // Text Scrolling Simulation Logic
                            let msg = document.getElementById('scrollText').value || "VIOLA ❤️";
                            draw(x, y, 20, 20, 20); // Background
                            // Simple text rendering placeholder
                            if ((x + Math.floor(time*10)) % 10 < 5) draw(x, y, 255, 100, 0); 
                        }
                    }
                }
            }, 33);
        }

        function hsvToRgb(h, s, v) {
            let r, g, b, i = Math.floor(h / 60), f = h / 60 - i, p = v * (1 - s), q = v * (1 - f * s), t = v * (1 - (1 - f) * s);
            switch (i % 6) {
                case 0: r = v, g = t, b = p; break; case 1: r = q, g = v, b = p; break; case 2: r = p, g = v, b = t; break;
                case 3: r = p, g = q, b = v; break; case 4: r = t, g = p, b = v; break; case 5: r = v, g = p, b = q; break;
            }
            return [r * 255, g * 255, b * 255];
        }

        function updateGCC(v) { gcc = v / 255; }
        function stop() { if(animTimer) clearInterval(animTimer); animTimer = null; }
        window.onload = () => { /* Initial draw code */ };
    </script>
</body>
</html>
