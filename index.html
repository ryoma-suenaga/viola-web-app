<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VIOLA | ams OSRAM Controller</title>
    <style>
        :root { --accent: #ff5e00; --bg: #050505; --card: #141414; --text: #ffffff; }
        body { font-family: 'Inter', -apple-system, sans-serif; background: var(--bg); color: var(--text); margin: 0; display: flex; flex-direction: column; align-items: center; min-height: 100vh; padding-bottom: 50px; }
        
        /* Brand Header */
        .header { width: 100%; padding: 40px 0; text-align: center; background: linear-gradient(180deg, #111 0%, transparent 100%); }
        .logo-img { width: 240px; height: auto; margin-bottom: 10px; filter: drop-shadow(0 0 15px rgba(255,94,0,0.3)); }
        h1 { margin: 0; font-size: 1rem; letter-spacing: 5px; font-weight: 300; color: #777; text-transform: uppercase; }

        /* 8x8 Matrix Simulator Shell */
        #matrix-shell { background: #000; padding: 20px; border-radius: 20px; border: 1px solid #222; box-shadow: 0 10px 40px rgba(0,0,0,1); margin: 20px 0; }
        #matrix { display: grid; grid-template-columns: repeat(8, 32px); gap: 6px; }
        .led { width: 32px; height: 32px; background: #111; border-radius: 4px; position: relative; transition: background 0.1s; }
        .led::after { content: ''; position: absolute; inset: 0; border-radius: 4px; filter: blur(4px); opacity: 0.7; background: inherit; }

        /* Professional Control UI */
        .container { width: 90%; max-width: 400px; display: flex; flex-direction: column; gap: 15px; }
        .card { background: var(--card); border-radius: 16px; padding: 20px; border: 1px solid #222; }
        .label { font-size: 0.7rem; color: #555; text-transform: uppercase; letter-spacing: 2px; margin-bottom: 12px; display: block; font-weight: bold; }
        
        button { background: #1a1a1a; border: 1px solid #333; color: #fff; padding: 14px; border-radius: 10px; cursor: pointer; transition: 0.2s; font-size: 0.85rem; }
        button:active { background: var(--accent); color: #000; transform: scale(0.98); }
        .btn-primary { background: var(--accent); color: #fff; border: none; font-weight: bold; width: 100%; box-shadow: 0 4px 15px rgba(255,94,0,0.2); }

        input[type="range"] { width: 100%; accent-color: var(--accent); margin: 10px 0; }
        input[type="color"] { width: 100%; height: 50px; border: none; border-radius: 8px; background: none; cursor: pointer; }
        .grid-2 { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
    </style>
</head>
<body>

    <div class="header">
        <img src="Logo.png" alt="ams OSRAM" class="logo-img">
        <h1>Viola Ecosystem</h1>
    </div>

    <div id="matrix-shell">
        <div id="matrix"></div>
    </div>

    <div class="container">
        <button class="btn-primary" onclick="connect()">INITIALIZE SYSTEM</button>

        <div class="card">
            <span class="label">Atmospheric Color</span>
            <input type="color" id="picker" value="#ff5e00" oninput="setStatic(this.value)">
        </div>

        <div class="card">
            <span class="label">Intensity (GCC)</span>
            <input type="range" min="0" max="255" value="128" oninput="updateGCC(this.value)">
        </div>

        <div class="card">
            <span class="label">Operational Modes</span>
            <div class="grid-2">
                <button onclick="runMode('phoenix')">PHOENIX</button>
                <button onclick="runMode('ocean')">OCEAN</button>
                <button onclick="runMode('plasma')">PLASMA</button>
                <button onclick="runMode('off')" style="color: #ff4444;">OFF</button>
            </div>
        </div>
    </div>

    <script>
        const matrixEl = document.getElementById('matrix');
        const leds = [];
        let gcc = 0.5;
        let interval = null;
        let tick = 0;

        // 1. Corrected Matrix Initialization
        function initMatrix() {
            matrixEl.innerHTML = ''; // Clear existing
            for (let i = 0; i < 64; i++) {
                const led = document.createElement('div');
                led.className = 'led';
                matrixEl.appendChild(led);
                leds.push(led);
            }
        }

        function draw(x, y, r, g, b) {
            const index = y * 8 + x;
            if (leds[index]) {
                leds[index].style.background = `rgb(${r * gcc}, ${g * gcc}, ${b * gcc})`;
            }
        }

        function setStatic(hex) {
            stop();
            const r = parseInt(hex.slice(1,3), 16), g = parseInt(hex.slice(3,5), 16), b = parseInt(hex.slice(5,7), 16);
            for(let i=0; i<64; i++) draw(i%8, Math.floor(i/8), r, g, b);
        }

        function runMode(mode) {
            stop();
            if (mode === 'off') { leds.forEach(l => l.style.background = '#080808'); return; }
            interval = setInterval(() => {
                tick += 0.2;
                for(let y=0; y<8; y++) {
                    for(let x=0; x<8; x++) {
                        if (mode === 'phoenix') {
                            const r = Math.max(0, 255 - (y * 32) - (Math.random() * 50));
                            draw(x, y, r, r * 0.25, 0);
                        } else if (mode === 'ocean') {
                            const b = Math.sin(x/2 + tick) * 50 + Math.sin(y/3 - tick) * 50 + 150;
                            draw(x, y, 0, b/2, b);
                        } else if (mode === 'plasma') {
                            const d = Math.sqrt((x-3.5)**2 + (y-3.5)**2);
                            const l = Math.sin(d - tick) * 0.5 + 0.5;
                            draw(x, y, 150*l, 50*l, 255*l);
                        }
                    }
                }
            }, 60);
        }

        function updateGCC(v) { gcc = v / 255; }
        function stop() { if(interval) clearInterval(interval); interval = null; }
        function connect() { alert("Simulating BLE connection to VIOLA..."); }

        // Start initialization on load
        window.onload = initMatrix;
    </script>
</body>
</html>
